<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Breaking Bad</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/api.css">
    <link rel="stylesheet" href="css/episode_card.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>

<!-- navbar -->
<nav class="navbar navbar-fixed-top navbar-expand-sm  ">
    <!-- Brand -->
    <a class="navbar-brand" href="#">Breaking Bad</a>

    <!-- Toggler/collapsibe Button -->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
        <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Links -->
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="#section_characters">Characters</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#section_episodes">Episodes</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#section_quotes">Quotes</a>
            </li>
        </ul>
    </div>

</nav>
<!--navbar -->

<!-- slider -->
<section id="section_slider" class="pb-5">
    <div class="container-fluid">
        <div class="row " id="SLIDER">
            <div id="carouselExampleIndicators" class="carousel slide " data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" src="img/1.jpg" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="img/2.jpg" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="img/4.jpg" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

        </div>
    </div>
</section>
<!--SLIDER-->
<!---------------->
<hr class="new5">
<!-- CHARACTERS -->
<section id="section_characters" class="pb-5">
    <div class="container">
        <h5 class="section-title h1">Breaking Bad Characters</h5>
        <div class="row" id="CHARACTERS">

        </div>
    </div>
</section>
<!-- CHARACTERS -->
<!---------------->
<!--  episodes  -->
<hr>
<section id="section_episodes" class="pb-5">
    <div class="container">
        <h5 class="section-title h1">BREAKING BAD EPISODES</h5>
        <div class="row" id="EPISODES">
        </div>
    </div>
</section>
<!-- episodes -->
<!--  Quotes  -->
<section id="section_quotes" class="pb-5">
    <div class="container">
        <h5 class="section-title h1">BREAKING BAD QUOTES</h5>
        <div class="row" id="QUOTES">

        </div>
    </div>
</section>
<!-- Quotes -->
<!--<a class="top-link hide" href="" id="js-top">-->
<!--    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>-->
<!--    <span class="screen-reader-text">Back to top</span>-->
<!--</a>-->

<script>
    async function getCharacters() {
        const response = await fetch("https://www.breakingbadapi.com/api/characters");
        const data = await response.json()
        return data;
    }
    async function getEpisodes() {
        const response = await fetch("https://www.breakingbadapi.com/api/episodes");
        const data = await response.json()
        return data;
    }
    async function getQuotes() {
        const response = await fetch("https://www.breakingbadapi.com/api/quotes");
        const data = await response.json()
        return data;
    }
    getCharacters().then(function (result) {
        console.log(result);
        for (i = 0; i<result.length; i++) {
            let name =  result[i].name;
            let img =  result[i].img;
            let nickname =  result[i].nickname
            let birthday =  result[i].birthday
            let portrayed =  result[i].portrayed
            let status = result[i].status;
            let occupation = result[i].occupation;
            let occupation_section = `<ul>`;
            occupation_section += `<li>${occupation[0]}</li>`;
            occupation_section += `</ul>`;
            let card = getCharacterCard(name, img, nickname, birthday, portrayed, status, occupation_section);
            $(`#CHARACTERS`).append(card);
        }
    });

    getQuotes().then(function (result) {
        for (i = 0; i<result.length; i++) {
            let quote =  result[i].quote;
            let author =  result[i].author;
            let card = getQuotesCard(quote, author);
            $(`#QUOTES`).append(card);
        }
    });

    function getQuotesCard(quote, author){
        var colors = ['#b8b5ff', '#ffd384', '#cee6b4'];
        var random_color = colors[Math.floor(Math.random() * colors.length)];
        return ` <blockquote class="quote-box card_text" style="background:${random_color};">
                  <p class="quotation-mark">
                    â€œ
                  </p>
                  <p class="quote-text">
                  ${quote}
                  </p>
                  <hr>
                  <div class="blog-post-actions">
                    <p class="blog-post-bottom pull-left">
                      ${author}
                    </p>
                  </div>
                </blockquote>`;
    }

    getEpisodes().then(function (result) {
        let img = 'img/6.jpg';
        for (i = 0; i<result.length; i++) {
            let title =  result[i].title;
            let characters =  result[i].characters;
            let episode = result[i].episode;
            let air_date = result[i].air_date;
            let season = result[i].season;
            let characters_section = '<ul>';
            characters_section += `<li>${characters[0]}</li>`;
            characters_section += `<li>${characters[1]}</li>`;
            characters_section += `<li>${characters[2]}</li>`;
            characters_section += `</ul>`;
            let card = getEpisodeCard(title,img, characters_section, episode, air_date,season);
            $(`#EPISODES`).append(card);
        }
    });

    function getEpisodeCard(title, img, characters_section, episode, air_date, season){
        return` <div class="col mb-3 col-md-3">
                    <!-- Card -->
                    <div class="card">

                        <!--Card image-->
                        <div class="view overlay">
                            <img class="card-img-top" src="${img}" alt="Card image cap">
                            <a href="#!"><div class="mask rgba-white-slight"></div></a>
                        </div>

                        <!--Card content-->
                        <div class="card-body">

                            <!--Title-->
                            <h4 class="card-title card_text">${title}</h4>
                            <!--air date-->
                            <h6 class="card_text">air date : ${air_date}</h6>
                            <!--episode-->
                            <h6 class="card_text">episode : ${episode}</h6>
                            <!--season-->
                            <h6 class="card_text">season : ${season}</h6>
                            <!--Text-->
                            <p class="card_text">characters</p>
                            <div class="row card_text">${characters_section}</div>
                            <!-- Provides extra visual weight and identifies the primary action in a set of buttons -->
                            <button type="button" class="btn btn-light-blue btn-md">Read more</button>

                        </div>

                    </div>
                    <!-- Card -->
                </div>`;
    }


    function getEpisodeCharacters(characters){
        let photos = '';
        for (i=0; i<characters.length; i++){
            let character_name = characters[i].name;
            let character_img = getCharacterImg(character_name);
            photos += character_img;
            // characters_images.append(character_img);
            // character_img.append(characters_images);

        }
        characters_images = `<div>${photos}</div>`;
        return $(characters_images).html();
    }

    async function getCharacterByName(name) {
        const response = await fetch("https://www.breakingbadapi.com/api/characters?name="+name);
        const data = await response.json()
        return data;
    }

    function getCharacterImg(character_name) {
       getCharacterByName(character_name).then(function (character){
           return `<img style="border-radius: 45px; border: 1px solid white" src="${character.img}"/>`
       });
    }


    function getCharacterCard(name, img, nickname, birthday, portrayed, status, occupation_section){
        return `  <!-- Team member -->
            <div class="col-xs-12 col-sm-6 col-md-4">
                <div class="image-flip" ontouchstart="this.classList.toggle('hover');">
                    <div class="mainflip">
                        <div class="frontside">
                            <div class="card">
                                <div class="card-body text-center">
                                    <p><img class=" img-fluid" src="${img}" alt="card image"></p>
                                    <h4 class="card-title">${name}</h4>
                                    <p class="card_text"> Nickname: ${nickname}</p>
                                    <p class="card_text"> Birthday: ${birthday}</p>
                                    <p class="card_text"> Portrayed: ${portrayed}</p>
                                    <p class="card_text"> Status: ${status}</p>
                                    <a href="https://www.fiverr.com/share/qb8D02" class="btn btn-primary btn-sm"><i class="fa fa-plus"></i></a>
                                </div>
                            </div>
                        </div>
                        <div class="backside">
                            <div class="card">
                                <div class="card-body text-center mt-4">
                                    <h4 class="card-title">${name}</h4>
                                    <p class="card-text card_text">
                                    <p>Occupation</p>
                                    ${occupation_section}
                                    </p>
                                    <ul class="list-inline">
                                        <li class="list-inline-item">
                                            <a class="social-icon text-xs-center" target="_blank" href="https://www.fiverr.com/share/qb8D02">
                                                <i class="fa fa-facebook"></i>
                                            </a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a class="social-icon text-xs-center" target="_blank" href="https://www.fiverr.com/share/qb8D02">
                                                <i class="fa fa-twitter"></i>
                                            </a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a class="social-icon text-xs-center" target="_blank" href="https://www.fiverr.com/share/qb8D02">
                                                <i class="fa fa-skype"></i>
                                            </a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a class="social-icon text-xs-center" target="_blank" href="https://www.fiverr.com/share/qb8D02">
                                                <i class="fa fa-google"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ./Team member -->
`;
    }
</script>
</body>
</html>